{
    "github": {
        "giotto": {
            "version": "{{ package.version }}"
        }
    },
    "httpcopy": {
        "sandstone": {
            "src": [
                "https://bootswatch.com/sandstone/_bootswatch.scss",
                "https://bootswatch.com/sandstone/_variables.scss"
            ],
            "target": "scss/deps/bootswatch/sandstone/"
        },
        "slate": {
            "src": [
                "https://bootswatch.com/slate/_bootswatch.scss",
                "https://bootswatch.com/slate/_variables.scss"
            ],
            "target": "scss/deps/bootswatch/slate/"
        },
        "highlight": {
            "src": [
                "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/tomorrow.min.css",
                "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/zenburn.min.css"
            ],
            "target": "scss/deps/highlight/"
        }
    },
    "sass": {
        "options": {
            "executable": "./node_modules/.bin/node-sass"
        },
        "giotto": {
            "files": {
                "build/sandstone.css": "scss/sandstone.scss",
                "build/slate.css": "scss/slate.scss"
            }
        },
        "giottojs": {
            "files": {
                "giottojs/media/giottojs/sandstone.css": "scss/giottojs-sandstone.scss",
                "giottojs/media/giottojs/slate.css": "scss/giottojs-slate.scss"
            }
        }
    },
    "shell": {
        "d3_quant_path": {
            "command": "cd ../d3-quant && pwd"
        },
        "d3_quant_link": {
            "command": ["rm -rf ./node_modules/d3-quant",
                        "ln -s {{ d3_quant_path }} {{repo_path }}/node_modules/d3-quant"]
        },
        "giotto-dev": {
            "command": ["npm run-script build",
                       "cp build/giotto.js giottojs/media/giottojs/giotto.js"]
        },
        "giotto": {
            "command": ["npm test",
                        "./node_modules/.bin/uglifyjs ./build/giotto.js -c -m -o ./build/giotto.min.js"]
        },
        "giotto-bundle": {
            "command": ["zip -j build/giotto.zip -- LICENSE README.md build/*.js build/*.css"]
        },
        "giottojs_pre": {
            "command": [
                "cp build/giotto.js giottojs/media/giottojs/giotto.js"
            ]
        },
        "giottosjs_bundle": {
            "command": [
                "{{ python }} manage.py media --js-src giottojs/media",
                "./node_modules/.bin/eslint giottojs/media/js",
                "./node_modules/.bin/r.js -o ./giottojs/bundle.js optimize=none"
            ]
        },
        "giottojs_uglify": {
            "command": "./node_modules/.bin/uglifyjs giottojs/media/giottojs/giottojs.js -c -m -o giottojs/media/giottojs/giottojs.min.js"
        },
        "clean": {
            "command": ["rm -rf build",
                        "rm -rf coverage",
                        "rm -rf scss/deps",
                        "rm -rf giottojs/media/giottojs/*.js",
                        "rm -rf giottojs/media/giottojs/*.css",
                        "rm -rf giottojs/media/giottojs/*.json",
                        "rm -rf giottojs/media/lux"]
        },
        "highlight": {
            "command": [
                "mv scss/deps/highlight/tomorrow.min.css scss/deps/highlight/_tomorrow.css",
                "mv scss/deps/highlight/zenburn.min.css scss/deps/highlight/_zenburn.css"
            ]
        }
    },
    "s3": {
        "options": {
            "bucket": "quantmind-public"
        },
        "giotto": {
            "files": {
                "build/*.js": "giotto/{{ package.version }}/",
                "build/*.css": "giotto/{{ package.version }}/"
            }
        }
    },
    "watch": {
        "giotto": {
            "files": ["index.js", "src/**/*.js", "test/*.js"],
            "command": "giotto-dev"
        },
        "d3-quant": {
            "files": ["../d3-quant/index.js", "../d3-quant/src/*.js"],
            "command": "giotto-dev"
        },
        "giottojs": {
            "files": [
                "giottojs/media/js/*.js",
                "../lux/lux/media/js/*.js",
                "../lux/lux/media/js/**/*.js"
            ],
            "command": "giottojs-dev"
        },
        "giotto-scss": {
            "files": ["scss/*.scss", "scss/**/*.scss"],
            "command": "css"
        }
    },
    "tasks": {
        "clean": {
            "description": "Remove build files and directories",
            "command": ["shell:clean"]
        },
        "install": {
            "description": "Install and download scss files from bootswatch.com for giotto and giottojs",
            "command": ["httpcopy", "shell:highlight"]
        },
        "giotto": {
            "description": "Create the build/giotto.(js/css) files",
            "command": ["shell:giotto", "sass:giotto"]
        },
        "css": {
            "description": "Compile css files for both giotto and giottojs",
            "command": ["sass"]
        },
        "giotto-dev": {
            "description": "Eslint and build giotto.js file and run phantomJS tests",
            "command": ["d3_quant", "shell:giotto-dev"]
        },
        "giottojs-dev": {
            "description": "Create the giottojs.js file, used by watch server",
            "command": "shell:giottosjs_bundle"
        },
        "giottojs": {
            "description": "Create the giottojs/media/giottojs/giottojs.(js/css) files",
            "command": [
                "shell:giottojs_pre",
                "shell:giottosjs_bundle",
                "shell:giottojs_uglify",
                "sass:giottojs"
            ]
        },
        "js": {
            "description": "Create the giottojs.js file only, no min.js no css",
            "command": ["shell:giottojs"]
        },
        "release": {
            "description": "Make a new release",
            "command": ["s3:giotto"]
        },
        "d3_quant": {
            "description": "Create a symbolic link to d3-quant for development",
            "command": ["shell:d3_quant_path", "shell:d3_quant_link"]
        },
        "serve": {
            "description": "Starts development server",
            "command": ["watch"]
        }
    }
}
